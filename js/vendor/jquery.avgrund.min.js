/**
 *  jQuery Avgrund Popin Plugin
 *  http://github.com/voronianski/jquery.avgrund.js/
 *
 *  (c) 2012-2013 http://pixelhunter.me/
 *  MIT licensed
 */
(function(a){a.fn.avgrund=function(b){var c={width:380,height:280,showClose:false,showCloseText:"",closeByEscape:true,closeByDocument:true,holderClass:"",overlayClass:"",enableStackAnimation:false,onBlurContainer:"",openOnEvent:true,setEvent:"click",onLoad:false,onUnload:false,template:"<p>This is test popin content!</p>"};b=a.extend(c,b);return this.each(function(){var l=a(this),f=a("body"),i=b.width>640?640:b.width,j=b.height>350?350:b.height,k=typeof b.template==="function"?b.template(l):b.template;f.addClass("avgrund-ready");f.append('<div class="avgrund-overlay '+b.overlayClass+'"></div>');if(b.onBlurContainer!==""){a(b.onBlurContainer).addClass("avgrund-blur");}function h(m){if(b.closeByEscape){if(m.keyCode===27){d();}}}function g(m){if(b.closeByDocument){if(a(m.target).is(".avgrund-overlay, .avgrund-close")){m.preventDefault();d();}}else{if(a(m.target).is(".avgrund-close")){m.preventDefault();d();}}}function e(){if(typeof b.onLoad==="function"){b.onLoad(l);}setTimeout(function(){f.addClass("avgrund-active");},100);f.append('<div class="avgrund-popin '+b.holderClass+'">'+k+"</div>");a(".avgrund-popin").css({width:i+"px",height:j+"px","margin-left":"-"+(i/2+10)+"px","margin-top":"-"+(j/2+10)+"px"});if(b.showClose){a(".avgrund-popin").append('<a href="#" class="avgrund-close">'+b.showCloseText+"</a>");}if(b.enableStackAnimation){a(".avgrund-popin").addClass("stack");}f.bind("keyup",h);f.bind("click",g);}function d(){f.unbind("keyup",h);f.unbind("click",g);f.removeClass("avgrund-active");setTimeout(function(){a(".avgrund-popin").remove();},500);if(typeof b.onUnload==="function"){b.onUnload(l);}}if(b.openOnEvent){l.bind(b.setEvent,function(m){m.stopPropagation();if(a(m.target).is("a")){m.preventDefault();}e();});}else{e();}});};})(jQuery);